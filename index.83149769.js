function t(t,s,i){return s in t?Object.defineProperty(t,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[s]=i,t}class s{darken(t,s,i){return[t,Math.ceil(1.1*s),Math.ceil(.9*i)]}arrToHsl(t){return`hsl(${t[0]}, ${t[1]}%, ${t[2]}%)`}}const i=(t,s)=>{t.beginPath(),s.forEach((([s,i])=>{t.lineTo(s,i)})),t.stroke(),t.closePath(),t.fill()};class e{setInitialColor(t){this.color=t}setOffset(t){this.offset=t}setMinWidth(t){this.minWidth=t}getRandomOffsetX(t){return Math.floor(Math.random()*this.minWidth+30*t)}getBuildingParts(t){const s=t.map((([t,s])=>[t-10,s+5])),i=s.map((([i,e],o)=>[[i,e],t[o],t[o+1]?t[o+1]:t[0],s[o+1]?s[o+1]:s[0]]));return{backSide:t,frontSide:s,asides:i}}drawOneBuilding(t){const{frontSide:s,asides:e}=this.getBuildingParts(t);this.ctx.fillStyle=this.colorHelper.arrToHsl(this.colorHelper.darken(...this.color)),e.forEach((t=>{i(this.ctx,t)})),this.ctx.fillStyle=this.colorHelper.arrToHsl(this.color),i(this.ctx,s)}addOffsetToCoords(t,s){const i=[];return t.forEach((([t,e])=>{i.push([t+s.x,e+s.y])})),i}getBuildingType(t){return t>this.rowCount/3?Math.floor(3*Math.random()+3):Math.floor(5*Math.random()+3)}generateRowBuildings(t,s){const i=this.getBuildingType(s);let e=this.buildingGenerator.generateBuilding(i);return t+=this.getRandomOffsetX(s),e=this.addOffsetToCoords(e,{x:this.offset.x+t,y:this.offset.y}),{buildingCoords:e,offsetX:t+=e[e.length-1][0]-e[0][0]}}drawBuildingsRow(t){this.ctx.strokeStyle="transparent";let s,i=0;for(;i+this.offset.x<window.innerWidth;)({offsetX:i,buildingCoords:s}=this.generateRowBuildings(i,t)),this.drawOneBuilding(s)}drawCity(){for(let t=this.rowCount-1;t>=0;t--){this.buildingGenerator.setHeight(Math.floor(12*Math.random()*t+30));const s=Math.floor(100*Math.random()-200);this.setOffset({x:s,y:this.offset.y+5}),this.drawBuildingsRow(t),this.color=this.colorHelper.darken(...this.color)}}constructor(i,e){t(this,"minWidth",20),t(this,"offset",{x:0,y:250}),t(this,"rowCount",10),t(this,"color",void 0),this.ctx=i,this.buildingGenerator=e,this.colorHelper=new s}}class o extends e{setShadowCtx(t){this.shadowCtx=t}setShadowColor(t){this.shadowColor=t}saveBuildingShadow(t){let s=0;const i=t.map((([i,e],o)=>{if(0===o||o===t.length-1)return s=e,[i,e];return[i+20,s-e+s]}));this.shadowCoords.push(i)}drawOneBuilding(t){super.drawOneBuilding(t),this.saveBuildingShadow(t)}setShadowOffset(t,s){return t.map((([i,e],o)=>0===o||o===t.length-1?[i,e]:[i+s,e]))}drawShadows(t){this.shadowCtx.fillStyle=this.shadowColor,this.shadowCtx.strokeStyle="transparent",this.shadowCoords.forEach((s=>{const e=this.setShadowOffset(s,t);i(this.shadowCtx,e)}))}constructor(...s){super(...s),t(this,"shadowCoords",[])}}class a{static defineStartPos(t,s){this.startX=t,this.startY=s}static defineMinWidth(t){this.minWidth=t}static setHeight(t){this.height=t}static getNextCoordinates(t,s,i){return[s,i]}static generateBuilding(){let t=[this.startX,this.startY],s=[t];for(let i=0;i<this.sideCount;i++)t=this.getNextCoordinates(i,...t),s.push(t);return s}}t(a,"sideCount",3),t(a,"minWidth",void 0),t(a,"height",void 0),t(a,"startX",void 0),t(a,"startY",void 0);class h extends a{static getNextCoordinates(t,s,i){let e=Math.floor(30*Math.random()+this.minWidth+s),o=t===this.sideCount-1?this.startY:-Math.floor(30*Math.random()+this.height-30);return 0!==t&&t!==this.sideCount-1||(e=s),[e,o]}}t(h,"sideCount",3);class n extends a{static getNextCoordinates(t,s,i){let e;1!==t&&2!==t||(e=s+20);let o=1===t?i-20:-Math.floor(30*Math.random()+this.height-30);return 2===t&&(o=i),t===this.sideCount-1&&(o=this.startY),0!==t&&t!==this.sideCount-1||(e=s),[e,o]}}t(n,"sideCount",4);class r extends a{static getNextCoordinates(t,s,i){let e=Math.floor(30*Math.random()+this.minWidth+s),o=t===this.sideCount-1?this.startY:-Math.floor(30*Math.random()+this.height-30);return t%2==0&&(e=s),t%2==1&&(o=i),[e,o]}}t(r,"sideCount",5);class d extends a{static getNextCoordinates(t,s,i){let e=Math.floor(30*Math.random()+150+s),o=t===this.sideCount-1?this.startY:i;return 0===t&&(o=-Math.floor(30*Math.random()+this.height-60)),0!==t&&t!==this.sideCount-1||(e=s),[e,o]}}t(d,"sideCount",3);class l extends a{static getNextCoordinates(t,s,i){let e=s+35,o=t===this.sideCount-1?this.startY:i-Math.floor(30*Math.random()+this.height);return t%2==0&&(e=s),t%2==1&&(o=i),[e,o]}}t(l,"sideCount",5);class c{setHeight(t){this.height=t}generateBuilding(t){switch(a.defineStartPos(this.startX,this.startY),a.defineMinWidth(this.minWidth),a.setHeight(this.height),t){case 3:return h.generateBuilding();case 4:default:return n.generateBuilding();case 5:return r.generateBuilding();case 6:return d.generateBuilding();case 7:return l.generateBuilding()}}constructor(s,i){t(this,"minWidth",20),t(this,"height",100),this.startX=s,this.startY=i}}class u{updateSize(){this.domCanvas.width=window.innerWidth,this.domCanvas.height=window.innerHeight}setCanvasBackground(){const t=this.ctx.createLinearGradient(0,0,0,this.domCanvas.height);t.addColorStop(0,"#80deea"),t.addColorStop(.37,"#ffccbc"),t.addColorStop(1,"hsl(5, 100%, 75%)"),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.domCanvas.width,this.domCanvas.height)}constructor(t){this.domCanvas=document.getElementById(t),this.domCanvas.width=window.innerWidth,this.domCanvas.height=window.innerHeight,this.ctx=this.domCanvas.getContext("2d")}}class f{setPosition(t,s){this.x=t,this.y=s}draw(){this.ctx.fillStyle="#ffffe3",this.ctx.strokeStyle="#ffffe3",this.ctx.beginPath(),this.ctx.arc(this.x,this.y,25,0,2*Math.PI),this.ctx.stroke(),this.ctx.shadowColor="#fffd9e",this.ctx.shadowBlur=50,this.ctx.fill(),this.ctx.shadowBlur=0}constructor(t){this.ctx=t,this.x=0,this.y=0}}class g{setXPosition(t){this.x=t}calculateSunPosition(){let t=-Math.sqrt(this.radius**2-(this.x-this.center.x)**2)+this.center.y;return t>this.yMax/2?[]:[this.x,t]}calculateShadowOffset(){return.2*(this.center.x-this.x)}constructor(t,s){this.xMax=t,this.yMax=s,this.radius=Math.round(t/2);let i=Math.round(t/2),e=Math.sqrt(this.radius**2-(0-i)**2)-100+s;t<s&&(e=this.radius,this.radius+=100);this.radius>e-50&&(e+=this.radius-e+50),this.center={x:i,y:e},this.x=0}}let C=0;const w=(t,s)=>{const i=new c(...[10,100]),e=new o(t.ctx,i);e.setOffset({...e.offset,y:t.domCanvas.height/2}),e.setShadowCtx(s.ctx),e.setInitialColor([231,44,74]),e.setShadowColor("hsl(5, 100%, 75%)"),e.drawCity(),cancelAnimationFrame(C),((t,s)=>{const i=s.domCanvas.width,e=s.domCanvas.height;let o=e>i?0:150;const a=new f(s.ctx),h=new g(i,e),n=()=>{s.ctx.clearRect(0,0,i,e),s.setCanvasBackground(),h.setXPosition(o),a.setPosition(...h.calculateSunPosition()),a.draw();const r=h.calculateShadowOffset();t.drawShadows(r),o++,o<s.domCanvas.width+150&&(C=requestAnimationFrame(n))};C=requestAnimationFrame(n)})(e,s)},x=(t,s)=>{t.ctx.clearRect(0,0,t.domCanvas.width,t.domCanvas.height),s.ctx.clearRect(0,0,t.domCanvas.width,t.domCanvas.height),w(t,s)};document.addEventListener("DOMContentLoaded",(()=>{const t=new u("shadowsCanvas"),s=new u("cityCanvas");x(s,t);document.querySelector(".generate-btn").addEventListener("click",(()=>x(s,t))),(t=>{let s=!1;window.addEventListener("resize",(()=>{clearTimeout(s),s=setTimeout(t,250)}))})((()=>{t.updateSize(),s.updateSize(),x(s,t)}))}));
//# sourceMappingURL=index.83149769.js.map
